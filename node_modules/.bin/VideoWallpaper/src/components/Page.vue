<template>
    <nav aria-label="Page navigation" v-if="this.total > 0">
        <ul class="pagination">
            <li v-if="this.activePage > 1" @click="activePage --">
                <a href="#" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li v-for="(value, key) in pageList" :class="{active: value.active}" @click="activePage = value.text"><a href="#">{{value.text}}</a></li>
            <li v-if="this.activePage < this.total" @click="activePage ++">
                <a href="#" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</template>

<script>
export default {
    name: 'page',
    props: ['total', 'pageNum'],
    data() {
        return {
            activePage: this.pageNum,
        }
    },
    computed: {
        showList() {
            let newList = [];
            if(this.total > 0){
                if(this.total < 5){
                    for(let i = 1; i <= this.total; i++) {
                        newList.push(i);
                    }
                } else {
                    if(this.activePage <= 2) {
                        newList = [1, 2, 3, 4, 5];
                    } else if(this.total >= this.activePage && this.total - this.activePage < 2) {
                        for (let i = this.total - 4; i <= this.total; i ++){
                            newList.push(i);
                        }
                    } else if (this.total > this.activePage ){
                        newList = [this.activePage - 2, this.activePage - 1, this.activePage, this.activePage + 1, this.activePage + 2];
                    } 
                }
            }
            return newList;
        },
        pageList() {
            let newList = [];
            for (let i = 0; i < this.showList.length; i++ ){
                let newPage = {};
                newPage.text = this.showList[i];
                newPage.active = this.showList[i] == this.activePage ? true : false;
                newList.push(newPage);
            }
            return newList;
        }
    },
    watch:{
        activePage() {
            this.$emit('changePage', {page: this.activePage});
        }
    }
}
</script>

<style scoped>
</style>

