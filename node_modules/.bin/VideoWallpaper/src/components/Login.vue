<template>
  <div id="login">
    <div  class="container">
      <div class="login-main">
        <logo id="logo"></logo>

        <div class="form-group">
          <input type="text" class="userName form-control" v-model="userName" placeholder="用户名"/>
        </div>

        <div class="form-group">
          <input type="password" class="password form-control" v-model="password" placeholder="密码"/>
        </div>

        <div class="form-group">
          <button class="loginBtn btn btn-block" @click="loginIn">sign in</button>
        </div>

        <div class="form-group">
          <a class="registeredBtn btn btn-link" href="#">立即注册</a>
          <a class="forgetBtn btn btn-link" href="#">忘记密码</a>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import logo from "@/components/Logo";

export default {
  name: "login",
  data() {
    return {
      msg: "login",
      userName: "",
      password: ""
    };
  },
  components: {
    logo
  },
  methods: {
    loginIn: function() {
      var $this = this;

      var loginAjax = function($this){
        return new Promise(function(resolve, reject){
          $.ajax({
            type: "post",
            url: "http://videowallpaper.rayhahah.com/user/login.do",
            ansyc: false,
            data:{
              email: $this.userName,
              password: $this.password
            },
            success: (result) => {
              resolve(result);
            },
            error: function(result) {
              console.log("error:" + resule)
            }
          });
        });
      }

      loginAjax(this).then((data) => {
        if(data.success && data.status == 0){
          sessionStorage.setItem('accessToken',true);
          this.$router.push({path: '/picture'});
        } else {
          $.alert({
            title: 'Login failed',
            content: data.msg,
            autoClose: 'confirm|3000',
            confirmButton: 'Yes'
          });
          return false;
        }
      },(error) => {
        console.log(error);
      })
    }
  },

};
</script>

<style scoped>
#login {
  background-color: #334054;
  height: 100%;
  overflow: hidden;
}

#logo {
  margin-top: 15vh;
  margin-bottom: 7vh;
}

.login-main {
  max-width: 350px;
  margin: 0 auto;
}

.loginBtn {
  color: #fff;
  background: #53d192;
  border-color: #53d192;
}

.registeredBtn {
  float: left;
}

.forgetBtn {
  float: right;
}
</style>
